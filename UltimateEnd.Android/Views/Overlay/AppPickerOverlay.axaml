<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:behaviors="using:UltimateEnd.Behaviors"
             x:Class="UltimateEnd.Android.Views.Overlays.AppPickerOverlay">

	<Grid Name="MainGrid"
		  IsVisible="False"
		  Background="#80000000"
		  ZIndex="2000"
		  PointerPressed="OnBackgroundClick">
		<Border Name="PickerPanel"
				Background="{DynamicResource Background.Card}"
				CornerRadius="12,0,0,12"
				Padding="10"
				HorizontalAlignment="Right"
				VerticalAlignment="Stretch"
				Width="{StaticResource Size.OverlayWidth}">
			<Grid RowDefinitions="Auto,Auto,*,Auto" VerticalAlignment="Stretch">
				<!-- 헤더 -->
				<Border Grid.Row="0"
						Background="{DynamicResource Background.Secondary}"
						Padding="10"
						BorderThickness="0,0,0,1"
						BorderBrush="{DynamicResource Background.Border}">
					<Grid ColumnDefinitions="Auto,*">
						<Border Grid.Column="0"
								ClipToBounds="False"
								PointerPressed="OnClose"
								Cursor="Hand"
								Margin="0,0,15,0">
							<PathIcon Classes="AnimatedIcon"
									  Data="{StaticResource Icon.Back}"
									  Width="{StaticResource IconSize.MenuIcon}"
									  Height="{StaticResource IconSize.MenuIcon}"
									  VerticalAlignment="Center"/>
						</Border>
						<TextBlock Grid.Column="1"
								   Text="앱 선택"
								   FontSize="20"
								   
								   Foreground="{DynamicResource Text.Primary}"
								   VerticalAlignment="Center"/>
					</Grid>
				</Border>

				<!-- 검색 -->
				<Border Grid.Row="1" Padding="10">
					<TextBox Name="SearchBox"
							 Watermark="앱 검색..."
							 Foreground="{DynamicResource Text.Primary}">
						<Interaction.Behaviors>
							<behaviors:TextBoxColorFixBehavior/>
						</Interaction.Behaviors>
					</TextBox>
				</Border>

				<!-- 로딩 표시 -->
				<StackPanel Grid.Row="2"
							Name="LoadingPanel"
							VerticalAlignment="Center"
							HorizontalAlignment="Center"
							Spacing="10">
					<TextBlock Text="앱 목록 로딩 중..."
							   FontSize="16"
							   Foreground="{DynamicResource Text.Primary}"
							   HorizontalAlignment="Center"/>
				</StackPanel>

				<!-- 앱 목록 -->
				<ScrollViewer Grid.Row="2" Name="AppScrollViewer" IsVisible="False">
					<ItemsControl Name="AppItemsControl">
						<ItemsControl.ItemTemplate>
							<DataTemplate>
								<Border Background="{DynamicResource Background.Secondary}"
										CornerRadius="8"
										Padding="8"
										Margin="0,0,0,5"
										Cursor="Hand"
										Tapped="OnAppItemTapped">
									<Grid ColumnDefinitions="Auto,*">
										<Image Grid.Column="0"
											   Source="{Binding Icon}"
											   Width="48"
											   Height="48"
											   Margin="0,0,12,0"/>
										<StackPanel Grid.Column="1" VerticalAlignment="Center">
											<TextBlock Text="{Binding DisplayName}"
													   
													   FontSize="16"
													   Foreground="{DynamicResource Text.Primary}"
													   TextTrimming="CharacterEllipsis"/>
											<TextBlock Text="{Binding PackageName}"
													   FontSize="11"
													   Foreground="{DynamicResource Text.Muted}"
													   TextTrimming="CharacterEllipsis"
													   Margin="0,2,0,0"/>
											<TextBlock Text="{Binding ActivityName}"
													   FontSize="10"
													   Foreground="{DynamicResource Text.Muted}"
													   TextTrimming="CharacterEllipsis"
													   Margin="0,2,0,0"/>
										</StackPanel>
									</Grid>
								</Border>
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
				</ScrollViewer>

				<!-- 하단 버튼 -->
				<Border Grid.Row="3"
						Background="{DynamicResource Background.Secondary}"
						Padding="10"
						BorderThickness="0,1,0,0"
						BorderBrush="{DynamicResource Background.Border}">
					<Button Content="취소"
							Click="OnCancelClick"
							Focusable="False"
							Background="{DynamicResource Background.Hover}"
							Foreground="{DynamicResource Text.Primary}"
							HorizontalAlignment="Stretch"/>
				</Border>
			</Grid>
		</Border>
	</Grid>
</UserControl>