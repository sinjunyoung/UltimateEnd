<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converters="using:UltimateEnd.Converters"
             xmlns:models="using:UltimateEnd.ViewModels"
             x:Class="UltimateEnd.Views.Overlays.BackupListOverlay">

	<UserControl.Resources>
		<converters:BoolToHighlightBrushConverter x:Key="BoolToHighlightBrush"/>
	</UserControl.Resources>
	
	<Grid
        Name="MainGrid"
        IsVisible="False"
        Background="#80000000"
        ZIndex="2000"
        PointerPressed="OnBackgroundClick">
		<Border Name="BackupListPanel"
                Background="{DynamicResource Background.Card}"
                CornerRadius="12,0,0,12"
                Padding="10"
                HorizontalAlignment="Right"
                VerticalAlignment="Stretch"
                Width="{StaticResource Size.OverlayWidth}">
			<Grid RowDefinitions="Auto,Auto,*,Auto" VerticalAlignment="Stretch">

				<!-- 헤더 -->
				<Border Grid.Row="0"
                        Background="{DynamicResource Background.Secondary}"
                        Padding="10"
                        BorderThickness="0,0,0,1"
                        BorderBrush="{DynamicResource Background.Border}">
					<Grid ColumnDefinitions="Auto,*">
						<Border Grid.Column="0"
                                ClipToBounds="False"
                                PointerPressed="OnCancelClick"
                                Cursor="Hand"
                                Margin="0,0,15,0">
							<PathIcon Classes="AnimatedIcon"
                                      Data="{StaticResource Icon.Back}"
                                      Width="{StaticResource IconSize.MenuIcon}"
                                      Height="{StaticResource IconSize.MenuIcon}"
                                      VerticalAlignment="Center"/>
						</Border>
						<TextBlock Grid.Column="1"
                                   Text="세이브 복원"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource Text.Primary}"
                                   VerticalAlignment="Center"/>
					</Grid>
				</Border>

				<!-- 게임명 -->
				<Border Grid.Row="1"
                        Background="{DynamicResource Background.Secondary}"
                        Padding="10,8"
                        Margin="5">
					<TextBlock Name="GameNameText"
                               FontSize="14"
                               Foreground="{DynamicResource Text.Secondary}"
                               TextWrapping="Wrap"/>
				</Border>

				<!-- 백업 리스트 -->
				<ScrollViewer Grid.Row="2">
					<ItemsRepeater Name="BackupList">
						<ItemsRepeater.Layout>
							<StackLayout Spacing="0" />
						</ItemsRepeater.Layout>
						<ItemsRepeater.ItemTemplate>
							<DataTemplate DataType="{x:Type models:BackupItemViewModel}">
								<Border Background="{DynamicResource Background.Secondary}"
                                        CornerRadius="8"
                                        Margin="5"
                                        Cursor="Hand"
                                        PointerPressed="OnBackupItemClick">
									<Grid ColumnDefinitions="*,Auto"
										  Background="{Binding IsSelected, Converter={StaticResource BoolToHighlightBrush}}">
										<!-- 백업 정보 -->
										<StackPanel Grid.Column="0" Spacing="4">
											<TextBlock Text="{Binding DisplayName}"
													   FontSize="14"
													   FontWeight="SemiBold"
													   Foreground="{DynamicResource Text.Primary}"/>
											<TextBlock Text="{Binding FileName}"
													   FontSize="11"
													   Foreground="{DynamicResource Text.Secondary}"/>
										</StackPanel>
									</Grid>
								</Border>
							</DataTemplate>
						</ItemsRepeater.ItemTemplate>
					</ItemsRepeater>
				</ScrollViewer>

				<!-- 버튼 -->
				<Grid Grid.Row="3"
					  ColumnDefinitions="*,Auto,Auto"
					  ColumnSpacing="10"
					  Margin="5,10,5,5">
					<Button Grid.Column="1"
							Content="취소"
							Focusable="False"
							Click="OnCancelClick"
							Padding="30,12"
							Background="{DynamicResource Background.Hover}"
							Foreground="{DynamicResource Text.Primary}"
							BorderThickness="0"
							CornerRadius="6"
							Cursor="Hand"/>
					<Button Grid.Column="2"
							Content="복원"
							Focusable="False"
							Click="OnRestoreClick"
							Padding="30,12"
							Background="{DynamicResource Accent.Blue}"
							Foreground="{DynamicResource Button.Foreground}"
							BorderThickness="0"
							CornerRadius="6"
							Cursor="Hand"/>
				</Grid>
			</Grid>
		</Border>
	</Grid>
</UserControl>