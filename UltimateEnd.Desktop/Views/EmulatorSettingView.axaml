<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:behaviors="using:UltimateEnd.Behaviors"
			 xmlns:views="using:UltimateEnd.Views.Overlays"
             x:Class="UltimateEnd.Desktop.Views.EmulatorSettingView"
			 Focusable="True">
	<Grid>
		<ScrollViewer>
			<StackPanel Margin="20" MaxWidth="900">

				<TextBlock Text="ì—ë®¬ë ˆì´í„° ì»¤ë§¨ë“œ ê´€ë¦¬"
						   Foreground="{DynamicResource Text.Primary}"
						   FontSize="24"
						   FontWeight="Bold"
						   Margin="0,0,0,20"/>

				<!-- ê²€ìƒ‰ ë° í•„í„° -->
				<Grid ColumnDefinitions="2*,*" Margin="0,0,0,15">
					<StackPanel Grid.Column="0" Margin="0,0,10,0">
						<TextBlock Text="ì»¤ë§¨ë“œ ê²€ìƒ‰" Foreground="{DynamicResource Text.Primary}"/>
						<TextBox x:Name="SearchTextBox"
								 Text="{Binding SearchText}"
								 Foreground="{DynamicResource Text.Primary}"
								 CaretBrush="{DynamicResource Text.Primary}"
								 Watermark="ì»¤ë§¨ë“œ ì´ë¦„ ë˜ëŠ” IDë¡œ ê²€ìƒ‰...">
							<TextBox.KeyBindings>
								<KeyBinding Gesture="Escape" Command="{Binding $parent[UserControl].DataContext.ClearSearchCommand}"/>
							</TextBox.KeyBindings>
							<Interaction.Behaviors>
								<behaviors:TextBoxColorFixBehavior/>
							</Interaction.Behaviors>
						</TextBox>
					</StackPanel>

					<StackPanel Grid.Column="1">
						<TextBlock Text="í”Œëž«í¼ í•„í„°" Foreground="{DynamicResource Text.Primary}"/>
						<ComboBox
							behaviors:InputMappingBehavior.Enable="True"
							SelectedItem="{Binding FilterPlatform}"
							ItemsSource="{Binding FilterPlatforms}">
							<ComboBox.ItemTemplate>
								<DataTemplate>
									<StackPanel Orientation="Horizontal" Spacing="8">
										<Image Source="{Binding Image}"
											   Width="20"
											   Height="20"
											   IsVisible="{Binding Image, Converter={x:Static ObjectConverters.IsNotNull}}"/>
										<TextBlock Text="{Binding DisplayName}"
												   VerticalAlignment="Center"/>
									</StackPanel>
								</DataTemplate>
							</ComboBox.ItemTemplate>
						</ComboBox>
					</StackPanel>
				</Grid>

				<!-- ì»¤ë§¨ë“œ ëª©ë¡ -->
				<TextBlock Text="ë“±ë¡ëœ ì»¤ë§¨ë“œ" Foreground="{DynamicResource Text.Primary}"/>
				<ListBox ItemsSource="{Binding FilteredCommands}"
						 x:Name="CommandListBox"
						 behaviors:InputMappingBehavior.Enable="True"
						 Focusable="True"
						 SelectedItem="{Binding SelectedCommand}"
						 Height="180"
						 Background="{DynamicResource Background.Input}"
						 SelectionChanged="OnCommandSelectionChanged"
						 Tapped="OnCommandTapped"
						 Margin="0,0,0,20">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<StackPanel Margin="5">
								<StackPanel Orientation="Horizontal">
									<Image Source="{Binding Icon}"
										   Width="32"
										   Height="32"
										   Margin="0,0,10,0"
										   IsVisible="{Binding Image, Converter={x:Static ObjectConverters.IsNotNull}}"/>
									<TextBlock Text="{Binding Name}"
											   FontWeight="SemiBold"
											   VerticalAlignment="Center"
											   Foreground="{DynamicResource Text.Primary}"
											   Width="200"/>
									<TextBlock Text="[RetroArch]"
											   Foreground="{DynamicResource Accent.Yellow}"
											   FontSize="11"
											   VerticalAlignment="Center"
											   Margin="5,0"
											   IsVisible="{Binding IsRetroArch}"/>
								</StackPanel>
								<TextBlock Text="{Binding Executable}"
										   Foreground="{DynamicResource Text.Muted}"
										   FontSize="11"
										   TextTrimming="CharacterEllipsis"
										   Margin="0,2,0,0"/>
							</StackPanel>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>

				<StackPanel Orientation="Horizontal" Margin="0,0,0,20">
					<Button Content="ì¶”ê°€"
							behaviors:SoundBehavior.ClickSound="OK"
							Focusable="False"
							Command="{Binding AddCommandCommand}"
							Background="{DynamicResource Accent.Blue}"
							Foreground="{DynamicResource Button.Foreground}"/>
					<Button Content="ë³µì œ"
							behaviors:SoundBehavior.ClickSound="OK"
							Focusable="False"
							Command="{Binding DuplicateCommandCommand}"
							Background="{DynamicResource Background.Hover}"
							Foreground="{DynamicResource Text.Primary}"/>
					<Button Content="ì‚­ì œ"
							behaviors:SoundBehavior.ClickSound="Cancel"
							Focusable="False"
							Command="{Binding DeleteCommandCommand}"
							Background="{DynamicResource Accent.Red}"
							Foreground="{DynamicResource Button.Foreground}"/>
				</StackPanel>

				<Separator Margin="0,10,0,20" Background="{DynamicResource Background.Border}"/>

				<!-- ì»¤ë§¨ë“œ ìƒì„¸ ì„¤ì • -->
				<Border BorderBrush="{DynamicResource Background.Border}"
						BorderThickness="1"
						CornerRadius="5"
						Padding="15"
						Background="{DynamicResource Background.Card}"
						IsVisible="{Binding SelectedCommand, Converter={x:Static ObjectConverters.IsNotNull}}">
					<StackPanel>

						<TextBlock Text="ì»¤ë§¨ë“œ ì •ë³´"
								   FontSize="18"
								   FontWeight="SemiBold"
								   Foreground="{DynamicResource Text.Primary}"
								   Margin="0,0,0,15"/>

						<TextBlock Text="ì»¤ë§¨ë“œ ì´ë¦„" Foreground="{DynamicResource Text.Primary}"/>
						<TextBox Text="{Binding SelectedCommand.Name}"
								 Foreground="{DynamicResource Text.Primary}"
								 CaretBrush="{DynamicResource Text.Primary}"
								 Watermark="ì˜ˆ: RetroArch - mGBA">
							<Interaction.Behaviors>
								<behaviors:TextBoxColorFixBehavior/>
							</Interaction.Behaviors>
						</TextBox>

						<CheckBox Content="RetroArch ì»¤ë§¨ë“œ"
								  IsChecked="{Binding SelectedCommand.IsRetroArch}"
								  Foreground="{DynamicResource Text.Primary}"
								  Margin="0,0,0,15">
							<Interaction.Behaviors>
								<behaviors:CheckBoxColorFixBehavior/>
							</Interaction.Behaviors>

						</CheckBox>

						<TextBlock Text="Core ì´ë¦„ (RetroArch ì „ìš©)"
								   Foreground="{DynamicResource Text.Primary}"
								   IsVisible="{Binding SelectedCommand.IsRetroArch}"/>
						<TextBox Text="{Binding SelectedCommand.CoreName}"
								 Foreground="{DynamicResource Text.Primary}"
								 CaretBrush="{DynamicResource Text.Primary}"
								 Watermark="ì˜ˆ: mgba_libretro"
								 IsVisible="{Binding SelectedCommand.IsRetroArch}">
							<Interaction.Behaviors>
								<behaviors:TextBoxColorFixBehavior/>
							</Interaction.Behaviors>
						</TextBox>

						<TextBlock Text="ì‹¤í–‰ íŒŒì¼ ê²½ë¡œ" Foreground="{DynamicResource Text.Primary}"/>
						<Grid ColumnDefinitions="*,Auto">
							<TextBox Grid.Column="0"
									 Foreground="{DynamicResource Text.Primary}"
									 CaretBrush="{DynamicResource Text.Primary}"
									 Text="{Binding SelectedCommand.Executable}"
									 Watermark="C:\RetroArch\retroarch.exe"
									 Margin="0,0,10,15">
								<Interaction.Behaviors>
									<behaviors:TextBoxColorFixBehavior/>
								</Interaction.Behaviors>
							</TextBox>
							<Button Grid.Column="1"
									Content="ì°¾ì•„ë³´ê¸°"
									Focusable="False"
									behaviors:SoundBehavior.ClickSound="OK"
									Background="{DynamicResource Accent.Blue}"
									Foreground="{DynamicResource Button.Foreground}"
									Command="{Binding BrowseExecutableCommand}"
									Margin="0,0,0,15"/>
						</Grid>

						<TextBlock Text="ìž‘ì—… ë””ë ‰í† ë¦¬ (ì„ íƒì‚¬í•­)" Foreground="{DynamicResource Text.Primary}"/>
						<Grid ColumnDefinitions="*,Auto">
							<TextBox Grid.Column="0"
									 Foreground="{DynamicResource Text.Primary}"
									 CaretBrush="{DynamicResource Text.Primary}"
									 Text="{Binding SelectedCommand.WorkingDirectory}"
									 Watermark="ë¹„ì›Œë‘ë©´ ì‹¤í–‰ íŒŒì¼ ìœ„ì¹˜ ì‚¬ìš©"
									 Margin="0,0,10,15">
								<Interaction.Behaviors>
									<behaviors:TextBoxColorFixBehavior/>
								</Interaction.Behaviors>
							</TextBox>
							<Button Grid.Column="1"
									Content="ì°¾ì•„ë³´ê¸°"
									Focusable="False"
									behaviors:SoundBehavior.ClickSound="OK"
									Background="{DynamicResource Accent.Blue}"
									Foreground="{DynamicResource Button.Foreground}"
									Command="{Binding BrowseWorkingDirCommand}"
									Margin="0,0,0,15"/>
						</Grid>

						<!-- ì‹¤í–‰ ì¸ìž -->
						<Grid RowDefinitions="Auto,Auto" Margin="0,0,0,15">
							<Grid Grid.Row="0" ColumnDefinitions="*,Auto" Margin="0,0,0,5">
								<TextBlock Grid.Column="0"
										   Text="ì‹¤í–‰ ì¸ìž (Arguments)"
										   Foreground="{DynamicResource Text.Primary}"/>
								<Button Grid.Column="1"
										x:Name="InsertVariableButton"
										Click="OnInsertVariableClicked"
										behaviors:SoundBehavior.ClickSound="OK"
										Focusable="False"
										Padding="8,4"
										Background="{DynamicResource Accent.Blue}"
										Foreground="{DynamicResource Button.Foreground}">
									<StackPanel Orientation="Horizontal" Spacing="5">
										<Image Source="avares://UltimateEnd/Assets/Icons/variable.png"
											   Width="16"
											   Height="16"/>
										<TextBlock Text="ë³€ìˆ˜"
												   FontSize="12"
												   VerticalAlignment="Center"/>
									</StackPanel>
								</Button>
							</Grid>
							<TextBox Grid.Row="1"
									 x:Name="ArgumentsTextBox"
									 Text="{Binding SelectedCommand.Arguments}"
									 CaretBrush="{DynamicResource Text.Primary}"
									 Foreground="{DynamicResource Text.Primary}"
									 Watermark="-L &quot;{corePath}&quot; &quot;{romPath} -f&quot;"
									 AcceptsReturn="True"
									 Height="80"
									 TextWrapping="Wrap">
								<Interaction.Behaviors>
									<behaviors:TextBoxColorFixBehavior/>
								</Interaction.Behaviors>
							</TextBox>
						</Grid>

						<TextBlock Text="â€¢ {rom} - ROM íŒŒì¼ ê²½ë¡œë¡œ ìžë™ ì¹˜í™˜ë©ë‹ˆë‹¤"
								   FontSize="12"
								   Foreground="{DynamicResource Text.Muted}"
								   Margin="0,0,0,15"/>

						<!-- Pre-launch Script -->
						<Grid RowDefinitions="Auto,Auto" Margin="0,0,0,15">
							<Grid Grid.Row="0" ColumnDefinitions="*,Auto,Auto" Margin="0,0,0,5">
								<TextBlock Grid.Column="0"
										   Text="Pre-launch Script (ì‹¤í–‰ ì „ ìŠ¤í¬ë¦½íŠ¸)"
										   Foreground="{DynamicResource Text.Primary}"/>
								<Button Grid.Column="1"
										x:Name="InsertPrelaunchVariableButton"
										Click="OnInsertPrelaunchVariableClicked"
										behaviors:SoundBehavior.ClickSound="OK"
										Focusable="False"
										Padding="8,4"
										Margin="0,0,5,0"
										Background="{DynamicResource Accent.Blue}"
										Foreground="{DynamicResource Button.Foreground}">
									<StackPanel Orientation="Horizontal" Spacing="5">
										<Image Source="avares://UltimateEnd/Assets/Icons/variable.png"
											   Width="16"
											   Height="16"/>
										<TextBlock Text="ë³€ìˆ˜"
												   FontSize="12"
												   VerticalAlignment="Center"/>
									</StackPanel>
								</Button>
								<Button Grid.Column="2"
										Command="{Binding BrowsePrelaunchScriptCommand}"
										behaviors:SoundBehavior.ClickSound="OK"
										Focusable="False"
										Padding="8,4"
										Background="{DynamicResource Background.Hover}"
										Foreground="{DynamicResource Text.Primary}">
									<StackPanel Orientation="Horizontal" Spacing="5">
										<TextBlock Text="ðŸ“"
												   FontSize="12"
												   VerticalAlignment="Center"/>
										<TextBlock Text="ì°¾ì•„ë³´ê¸°"
												   FontSize="12"
												   VerticalAlignment="Center"/>
									</StackPanel>
								</Button>
							</Grid>
							<TextBox Grid.Row="1"
									 x:Name="PrelaunchScriptTextBox"
									 Text="{Binding SelectedCommand.PrelaunchScript}"
									 CaretBrush="{DynamicResource Text.Primary}"
									 Foreground="{DynamicResource Text.Primary}"
									 Watermark="ì˜ˆ: scripts/mount-iso.bat &quot;{rom}&quot;"
									 AcceptsReturn="True"
									 Height="60"
									 TextWrapping="Wrap">
								<Interaction.Behaviors>
									<behaviors:TextBoxColorFixBehavior/>
								</Interaction.Behaviors>
							</TextBox>
						</Grid>

						<TextBlock Text="â€¢ ISO ë§ˆìš´íŠ¸ ë“± ê²Œìž„ ì‹¤í–‰ ì „ í•„ìš”í•œ ìž‘ì—… ìŠ¤í¬ë¦½íŠ¸"
								   FontSize="12"
								   Foreground="{DynamicResource Text.Muted}"
								   Margin="0,0,0,15"/>

						<!-- Post-launch Script -->
						<Grid RowDefinitions="Auto,Auto" Margin="0,0,0,15">
							<Grid Grid.Row="0" ColumnDefinitions="*,Auto,Auto" Margin="0,0,0,5">
								<TextBlock Grid.Column="0"
										   Text="Post-launch Script (ì‹¤í–‰ í›„ ìŠ¤í¬ë¦½íŠ¸)"
										   Foreground="{DynamicResource Text.Primary}"/>
								<Button Grid.Column="1"
										x:Name="InsertPostlaunchVariableButton"
										Click="OnInsertPostlaunchVariableClicked"
										behaviors:SoundBehavior.ClickSound="OK"
										Focusable="False"
										Padding="8,4"
										Margin="0,0,5,0"
										Background="{DynamicResource Accent.Blue}"
										Foreground="{DynamicResource Button.Foreground}">
									<StackPanel Orientation="Horizontal" Spacing="5">
										<Image Source="avares://UltimateEnd/Assets/Icons/variable.png"
											   Width="16"
											   Height="16"/>
										<TextBlock Text="ë³€ìˆ˜"
												   FontSize="12"
												   VerticalAlignment="Center"/>
									</StackPanel>
								</Button>
								<Button Grid.Column="2"
										Command="{Binding BrowsePostlaunchScriptCommand}"
										behaviors:SoundBehavior.ClickSound="OK"
										Focusable="False"
										Padding="8,4"
										Background="{DynamicResource Background.Hover}"
										Foreground="{DynamicResource Text.Primary}">
									<StackPanel Orientation="Horizontal" Spacing="5">
										<TextBlock Text="ðŸ“"
												   FontSize="12"
												   VerticalAlignment="Center"/>
										<TextBlock Text="ì°¾ì•„ë³´ê¸°"
												   FontSize="12"
												   VerticalAlignment="Center"/>
									</StackPanel>
								</Button>
							</Grid>
							<TextBox Grid.Row="1"
									 x:Name="PostlaunchScriptTextBox"
									 Text="{Binding SelectedCommand.PostlaunchScript}"
									 CaretBrush="{DynamicResource Text.Primary}"
									 Foreground="{DynamicResource Text.Primary}"
									 Watermark="ì˜ˆ: scripts/unmount-iso.bat"
									 AcceptsReturn="True"
									 Height="60"
									 TextWrapping="Wrap">
								<Interaction.Behaviors>
									<behaviors:TextBoxColorFixBehavior/>
								</Interaction.Behaviors>
							</TextBox>
						</Grid>

						<TextBlock Text="â€¢ ISO ì–¸ë§ˆìš´íŠ¸ ë“± ê²Œìž„ ì¢…ë£Œ í›„ ì •ë¦¬ ìž‘ì—… ìŠ¤í¬ë¦½íŠ¸"
								   FontSize="12"
								   Foreground="{DynamicResource Text.Muted}"
								   Margin="0,0,0,15"/>

						<!-- ì§€ì› í”Œëž«í¼ (íƒœê·¸ ë°©ì‹) -->
						<TextBlock Text="ì§€ì› í”Œëž«í¼" Foreground="{DynamicResource Text.Primary}"/>

						<!-- í”Œëž«í¼ ì¶”ê°€ -->
						<Grid ColumnDefinitions="*,Auto" Margin="0,0,0,10">
							<ComboBox Grid.Column="0"
									  SelectedItem="{Binding SelectedPlatformToAdd}"
									  ItemsSource="{Binding AvailablePlatforms}"
									  behaviors:InputMappingBehavior.Enable="True"
									  Margin="0,0,10,0">
								<ComboBox.ItemTemplate>
									<DataTemplate>
										<StackPanel Orientation="Horizontal" Spacing="8">
											<Image Source="{Binding Image}"
												   Width="32"
												   Height="32"/>
											<TextBlock Text="{Binding DisplayName}"
													   VerticalAlignment="Center"/>
										</StackPanel>
									</DataTemplate>
								</ComboBox.ItemTemplate>
							</ComboBox>
							<Button Grid.Column="1"
									Content="ì¶”ê°€"
									Focusable="False"
									behaviors:SoundBehavior.ClickSound="OK"
									Background="{DynamicResource Accent.Blue}"
									Foreground="{DynamicResource Button.Foreground}"
									Command="{Binding AddPlatformCommand}"
									Padding="15,8"/>
						</Grid>

						<!-- ì„ íƒëœ í”Œëž«í¼ íƒœê·¸ -->
						<Border BorderBrush="{DynamicResource Background.Border}"
								BorderThickness="1"
								CornerRadius="5"
								Padding="10"
								MinHeight="80"
								Margin="0,0,0,15"
								Background="{DynamicResource Background.Input}">
							<ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="150">
								<ItemsControl ItemsSource="{Binding SelectedPlatforms}">
									<ItemsControl.ItemsPanel>
										<ItemsPanelTemplate>
											<WrapPanel/>
										</ItemsPanelTemplate>
									</ItemsControl.ItemsPanel>
									<ItemsControl.ItemTemplate>
										<DataTemplate>
											<Border Background="{DynamicResource Accent.Blue.Transparent}"
													BorderBrush="{DynamicResource Accent.Blue}"
													BorderThickness="1"
													CornerRadius="4"
													Padding="8,4"
													Margin="4">
												<StackPanel Orientation="Horizontal" Spacing="8">
													<Image Source="{Binding Image}"
														   Width="32"
														   Height="32"
														   VerticalAlignment="Center"/>
													<TextBlock Text="{Binding Id}"
															   VerticalAlignment="Center"
															   Foreground="{DynamicResource Text.Primary}"
															   FontWeight="SemiBold"/>
													<Button Content="Ã—"
															Focusable="False"
															Command="{Binding DataContext.RemovePlatformCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
															CommandParameter="{Binding}"
															Background="Transparent"
															Foreground="{DynamicResource Accent.Red}"
															BorderThickness="0"
															Padding="4,0"
															FontSize="16"
															FontWeight="Bold"
															Cursor="Hand"
															ToolTip.Tip="ì œê±°"/>
												</StackPanel>
											</Border>
										</DataTemplate>
									</ItemsControl.ItemTemplate>
								</ItemsControl>
							</ScrollViewer>
						</Border>

						<!-- LaunchCommand ë¯¸ë¦¬ë³´ê¸° -->
						<TextBlock Text="ìµœì¢… LaunchCommand ë¯¸ë¦¬ë³´ê¸°" Foreground="{DynamicResource Text.Primary}"/>
						<TextBox Text="{Binding SelectedCommand.LaunchCommand}"
								 IsReadOnly="True"
								 Foreground="{DynamicResource Text.Primary}"
								 CaretBrush="{DynamicResource Text.Primary}"
								 Background="{DynamicResource Background.Input}"
								 AcceptsReturn="True"
								 Height="60"
								 TextWrapping="Wrap">
							<Interaction.Behaviors>
								<behaviors:TextBoxColorFixBehavior/>
							</Interaction.Behaviors>
						</TextBox>

						<StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
							<Button Content="ì·¨ì†Œ"
									Focusable="False"
									Command="{Binding GoBackCommand}"
									Background="{DynamicResource Accent.Red}"
									Foreground="{DynamicResource Button.Foreground}"
									Cursor="Hand"/>
							<Button Content="ì €ìž¥"
									Focusable="False"
									behaviors:SoundBehavior.ClickSound="OK"
									Command="{Binding SaveCommandCommand}"
									Background="{DynamicResource Accent.Blue}"
									Foreground="{DynamicResource Button.Foreground}"/>
						</StackPanel>

					</StackPanel>
				</Border>

				<!-- ì„ íƒëœ ì»¤ë§¨ë“œê°€ ì—†ì„ ë•Œ -->
				<Border BorderBrush="{DynamicResource Background.Border}"
						BorderThickness="1"
						CornerRadius="5"
						Padding="40"
						Background="{DynamicResource Background.Card}"
						IsVisible="{Binding SelectedCommand, Converter={x:Static ObjectConverters.IsNull}}">
					<TextBlock Text="ì»¤ë§¨ë“œë¥¼ ì„ íƒí•˜ê±°ë‚˜ ìƒˆë¡œ ì¶”ê°€í•´ì£¼ì„¸ìš”"
							   HorizontalAlignment="Center"
							   Foreground="{DynamicResource Text.Muted}"
							   FontSize="14"/>
				</Border>

			</StackPanel>
		</ScrollViewer>

		<!-- í…œí”Œë¦¿ ë³€ìˆ˜ ì„ íƒ ì˜¤ë²„ë ˆì´ -->
		<views:TemplateVariablePickerOverlay x:Name="TemplateVariablePickerOverlay" ZIndex="2000"/>
	</Grid>

</UserControl>